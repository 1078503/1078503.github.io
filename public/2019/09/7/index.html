<!DOCTYPE html>
<html>

<head>
    <title>【随笔】新开的VPS一般需要先做些什么 | 近视眼逛博客</title>

    <meta charset="utf-8">
    <meta http-equiv="content-type" content="text/html; charset=utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    
    
    

        <meta property="og:title" content="【随笔】新开的VPS一般需要先做些什么" />
    <meta property="og:description" content="" />
    <meta property="og:type" content="website" />
    <meta property="og:locale" content="zh" />
    <meta property="og:url" content="https://ditou.org/2019/09/7/" />
    

    <link rel="shortcut icon" href="/favicon.ico">

    <link href="https://ditou.org/webfonts/ptserif/main.css" rel='stylesheet' type='text/css'>
    <link href="https://ditou.org/webfonts/source-code-pro/main.css" rel="stylesheet" type="text/css">

    <link rel="stylesheet" href="https://ditou.org/css/style.css">
    

    <meta name="generator" content="Hugo 0.68.3" />

    <link href="https://fonts.loli.net/css2?family=EB+Garamond:ital,wght@0,400;0,500;0,700;1,400;1,700&family=Noto+Serif+SC:wght@400;500;700&family=Source+Code+Pro:ital,wght@0,400;0,700;1,400;1,700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="https://api.ditou.org/disqus/dist/iDisqus.min.css">
    <script src="https://api.ditou.org/disqus/dist/iDisqus.min.js"></script>

    <script async defer data-website-id="f3078441-b3d5-4d51-bc58-6c890c1075e0" src="https://status.ditou.org/umami.js"></script>
</head>

<body>
    <div id="container">
        <header id="header">
    <div id="header-outer" class="outer">
        <div id="header-inner" class="inner">
            <a id="main-nav-toggle" class="nav-icon" href="javascript:;"></a>
            <a id="logo" class="logo-text" href="https://ditou.org/" style="color: teal;">近视眼逛博客</a>
            <nav id="main-nav">
                
                <a class="main-nav-link" href="/categories">分类</a>
                
                <a class="main-nav-link" href="/tags">标签</a>
                
                <a class="main-nav-link" href="/about">关于</a>
                
                <a class="main-nav-link" href="/links">友链</a>
                
                <a class="main-nav-link" href=""></a>
                
                <a class="main-nav-link" href=""></a>
                
            </nav>
            <nav id="sub-nav">
                <div id="search-form-wrap">
                </div>
            </nav>
        </div>
    </div>
</header>

        <section id="main" class="outer">
            <article class="article article-type-post" itemscope itemprop="blogPost">
    <div class="article-inner">
        
        <header class="article-header">
            <h1 class="article-title" itemprop="name">【随笔】新开的VPS一般需要先做些什么</h1>
        </header>
        
        <div class="article-meta">
            <a href="/2019/09/7/" class="article-date">
                <time datetime='2019-09-26T00:23:45.000&#43;08:00' itemprop="datePublished">2019-09-26</time>
            </a>
            
            
            <div class="post-categories">
                <div class="article-category">
                    
                    
                    <a class="article-category-link" href="https://ditou.org//categories/%E7%94%B5%E8%84%91">电脑</a>
                    
                </div>
            </div>
            
            
        </div>
        <br>
        <div class="article-entry" itemprop="articleBody">
            <p>今天需要为博客换一个服务器，原因是<a href="https://www.vultr.com/?ref=7997010" target="_blank" rel="noopener">vultr</a>的余额即将耗尽。</p>
<p>虽然<a href="https://www.vultr.com/?ref=7997010" target="_blank" rel="noopener">vultr</a>的服务一直都很稳，但是另一家的余额还有一些不能浪费是吧！（其实就是穷。）等我去用它几个月争取早日把余额用完。</p>
<p>真正的云VPS虚拟机就是好，开起来很快就完工了，真正是数秒完成，vultr家的每次创建都还需要等一会儿呢。别的先不管，拿到IP第一时间看路由：https://tools.ipip.net/traceroute.php 。完成后看最后面的数字，一般在200以内就是很好的了，当然大家一般都是使用美西线路。不放心的话最好本地还是ping一下IP看看。</p>
<p>以上是为了验证IP在国内是否可用，为下一步继续配置系统做准备。</p>
<p>终端(比如xshell)连接到服务器运行<code>uname -r</code> 得到当前的系统版本：</p>
<pre><code class="language-shell">[root@1078503 ~]# uname -r
3.10.0-957.21.3.el7.x86_64
[root@1078503 ~]# 
</code></pre>
<p>如果你需要开启并使用BBR加速，就需要升级内核到最新版本；如果你需要使用docker更需要升级。</p>
<p>最新稳定版内核查看地址：https://www.kernel.org/</p>
<p>如果能一步就安装最新内核并开启 BBR 那最方便了，我先想到<a href="https://teddysun.com/489.html" target="_blank" rel="noopener">秋水逸冰</a>大佬的脚本，跑一下看看：</p>
<pre><code class="language-shell">wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh &amp;&amp; chmod +x bbr.sh &amp;&amp; ./bbr.sh
</code></pre>
<p>跑完<code>uname -r</code>验证一下：</p>
<pre><code class="language-shell">[root@1078503 ~]# uname -r
5.3.1-1.el7.elrepo.x86_64
[root@1078503 ~]# 
</code></pre>
<p>如果你发现不是最新版本可能需要设置<code>grub2-set-default 0</code>，将升级的内核应用到启动项并重启机器验证。如果大佬的脚本你无法跑起来，可以考虑手动将内核库添加到系统，然后手动安装最新的内核。当然你还需要手动安装BBR加速等，这里只是提供思路，一般centos 7系统是可以完美运行的。</p>
<p>有了最新的系统内核和BBR加速，无论你是要搭梯子还是跑博客服务都会很流畅很科学了😁。我经常遇到IP没有被墙但梯子速度很慢或者没什么速度的情况，这时候我每次检查都是系统版本降级了，升级一下内核就又飞起来了（大多数情况是自己瞎折腾后没有检查造成的）。</p>
<p>当然，有些功能还需要安装最新版内核 headers ：</p>
<pre><code class="language-shell">yum --enablerepo=elrepo-kernel -y install kernel-ml-headers
</code></pre>
<p>记得有朋友问我为什么你自己搭的梯子速度这么快，这一篇内容就是了。最新的系统内核加上BBR加速能不快吗？😄</p>
<p>如果只是放个博客其实这就无所谓了。不说了，我要去把我的博客搬到这台服务器上面了，保守估计放六个月的费用应该是够了。如果这期间它稳定我就一直放下去，反正便宜。</p>
<p>不过，当你看到这篇文章的时候我肯定已经搬完了。😁</p>
<hr>
<p>昨晚说了新开VPS需要做的一些工作。</p>
<p>隔天上午也就是现在想起来还需要补充一些。我们开的小鸡很容易被恶意扫描，有些频率过高的甚至会严重影响性能。这时候我们就需要采取一些措施，比如更改SSH的默认连接端口，还需要给SSH连接加上管理控制功能用于封禁不太友好的扫描IP。</p>
<p>其实做这些一个就够了：fail2ban。GitHub里面有大佬编译好的一键修改端口并安装fail2ban的脚本您可以自行搜索选择使用，真的很方便的，可以限制密码尝试次数和封禁IP时间多少小时等。我一般不完全封禁IP，众所周知这些来路的IP大多是VPS服务商的IP段，说不定哪天这个IP就被自己得到了那不就不太方便了吗？哈哈（其实一般这种情况很难出现）。</p>

        </div>

        
        
        <div class="article-toc" style="display:none;">
            <h3></h3>
            <nav id="TableOfContents"></nav>
        </div>
        
        

        
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.1.1/jquery.slim.min.js" integrity="sha256-/SIrNqv8h6QGKDuNoLGA4iret+kyesCkHGzVUUV0shc=" crossorigin="anonymous"></script>
        <script>
            (function() {
                var $toc = $('#TableOfContents');
                if ($toc.length > 0) {
                    var $window = $(window);

                    function onScroll(){
                        var currentScroll = $window.scrollTop();
                        var h = $('.article-entry h1, .article-entry h2, .article-entry h3, .article-entry h4, .article-entry h5, .article-entry h6');
                        var id = "";
                        h.each(function (i, e) {
                            e = $(e);
                            if (e.offset().top - 10 <= currentScroll) {
                                id = e.attr('id');
                            }
                        });
                        var active = $toc.find('a.active');
                        if (active.length == 1 && active.eq(0).attr('href') == '#' + id) return true;

                        active.each(function (i, e) {
                            $(e).removeClass('active').siblings('ul').hide();
                        });
                        $toc.find('a[href="#' + id + '"]').parentsUntil('#TableOfContents').each(function (i, e) {
                            $(e).children('a').addClass('active').siblings('ul').show();
                        });
                    }

                    $window.on('scroll', onScroll);
                    $(document).ready(function() {
                        $toc.find('a').parent('li').find('ul').hide();
                        onScroll();
                        document.getElementsByClassName('article-toc')[0].style.display = '';
                    });
                }
            })();
        </script>
        


        
        <footer class="article-footer">
            <ul class="article-tag-list">
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://ditou.org//tags/%E9%9A%8F%E7%AC%94">随笔
                    </a>
                </li>
                
                <li class="article-tag-list-item">
                    <a class="article-tag-list-link" href="https://ditou.org//tags/kernel%E5%86%85%E6%A0%B8%E5%8D%87%E7%BA%A7">kernel内核升级
                    </a>
                </li>
                
            </ul>
        </footer>
        
    </div>
    
<nav id="article-nav">
    
    <a href="/2019/09/8/" id="article-nav-newer" class="article-nav-link-wrap">
        <div class="article-nav-title"><span>&lt;</span>&nbsp;
            【随笔】无标题但标题要长那就这样吧
        </div>
    </a>
    
    
    <a href="/2019/09/6/" id="article-nav-older" class="article-nav-link-wrap">
        <div class="article-nav-title">【随笔】前天刚说完没动力昨晚回家就发现好事情😄&nbsp;<span>&gt;</span></div>
    </a>
    
</nav>


</article>

            
            <div align="center">
    <font style="color: red;font-family: sans-serif;font-size: 12px;" align="center">点击评论框“加入讨论”会显示名字邮箱网址选项，不一定需要登陆哦🙂
    </font>
</div>
<div style="background-color: #f9f9f9;">
    <center>
        <div id="comment" style="width: 90%;">
            <script>
                var disq = new iDisqus('comment', {
                    forum: '1078503',
                    api: 'https://api.ditou.org/disqus/api/',
                    site: 'https://ditou.org',
                    mode: 2,
                    timeout: 3000,
                    init: true
                });
            </script>
        </div>
    </center>
</div>
        </section>
        <div class="outer">
    <ul style="padding: 12px 13px 10px 0px;" class="shouyeyoulian">
        <li><a href="https://dtz9.com/" target="_blank">低头族中文社区</a></li>
        <li><a href="https://www.lfhacks.com/" target="_blank">LFhacks</a></li>
    </ul>
</div>
<footer id="footer">
    <div class="outer">
        <hr style=" border: 1px dashed #ddd;">
        <div id="footer-info" class="inner">
            &copy; 2019 - 2020 执迷不悟
            <br />
            <a href="https://gohugo.io" target="_blank">Hugo</a> 生成的博客 | 主题： <a href="https://github.com/carsonip/hugo-theme-minos" target="_blank">Minos</a> | <a href="/index.xml" target="_blank">RSS</a>
        </div>
    </div>
    

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/styles/tomorrow-night.min.css" integrity="sha256-2wL88NKUqvJi/ExflDzkzUumjUM73mcK2gBvBBeLvTk=" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.9.0/highlight.min.js" integrity="sha256-KbfTjB0WZ8vvXngdpJGY3Yp3xKk+tttbqClO11anCIU=" crossorigin="anonymous"></script>
    <script>
        hljs.initHighlightingOnLoad();
    </script>

    
    <script>
        document.getElementById('main-nav-toggle').addEventListener('click', function() {
            var header = document.getElementById('header');
            if (header.classList.contains('mobile-on')) {
                header.classList.remove('mobile-on');
            } else {
                header.classList.add('mobile-on');
            }
        });
    </script>
</footer>
<div id="backtop">
    <a href="#">TOP</a>
</div>
    </div>
</body>

</html>