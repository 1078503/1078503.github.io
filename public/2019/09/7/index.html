<!DOCTYPE html>
<html lang="zh-cn"><meta charset="utf-8"><meta name="generator" content="Hugo 0.60.0" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>【随笔】新开的VPS一般需要先做些什么&nbsp;&ndash;&nbsp;近视眼逛博客 DTZ9.NET</title><link rel="stylesheet" href="/css/core.min.23cf2408a7bbf383778ab163ca01c615250ed41c122a52c02d83618a440898a34d9584fae91a0a2c0da793b5121359c1.css" integrity="sha384-I88kCKe784N3irFjygHGFSUO1BwSKlLALYNhikQImKNNlYT66RoKLA2nk7USE1nB"><body>
    <div class="base-body"><section id="header" class="site header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><span class="site name">近视眼逛博客 DTZ9.NET</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/categories">分类</a><a class="nav item" href="/about">关于</a><a class="nav item" href="https://t.me/link1078503"target="_blank">群组</a><a class="nav item" href="/links">友链</a></nav></div></span></div></section><div id="content"><section class="article header">
    <h1 class="article title">【随笔】新开的VPS一般需要先做些什么</h1><p class="article date">2019-09-26</p></section><article class="article markdown-body"><p>今天需要为博客换一个服务器，原因是<a href="https://www.vultr.com/?ref=7997010">vultr</a>的余额即将耗尽。</p>
<p>虽然<a href="https://www.vultr.com/?ref=7997010">vultr</a>的服务一直都很稳，但是另一家的余额还有一些不能浪费是吧！（其实就是穷。）等我去用它几个月争取早日把余额用完。</p>
<p>真正的云VPS虚拟机就是好，开起来很快就完工了，真正是数秒完成，vultr家的每次创建都还需要等一会儿呢。别的先不管，拿到IP第一时间看路由：https://tools.ipip.net/traceroute.php 。完成后看最后面的数字，一般在200以内就是很好的了，当然大家一般都是使用美西线路。不放心的话最好本地还是ping一下IP看看。</p>
<p>以上是为了验证IP在国内是否可用，为下一步继续配置系统做准备。</p>
<p>终端(比如xshell)连接到服务器运行<code>uname -r</code> 得到当前的系统版本：</p>
<div class="highlight"><pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@1078503 ~<span class="o">]</span><span class="c1"># uname -r</span>
3.10.0-957.21.3.el7.x86_64
<span class="o">[</span>root@1078503 ~<span class="o">]</span># 
</code></pre></div><p>如果你需要开启并使用BBR加速，就需要升级内核到最新版本；如果你需要使用docker更需要升级。</p>
<p>最新稳定版内核查看地址：https://www.kernel.org/</p>
<p>如果能一步就安装最新内核并开启 BBR 那最方便了，我先想到<a href="https://teddysun.com/489.html">秋水逸冰</a>大佬的脚本，跑一下看看：</p>
<div class="highlight"><pre class="chroma"><code class="language-shell" data-lang="shell">wget --no-check-certificate https://github.com/teddysun/across/raw/master/bbr.sh <span class="o">&amp;&amp;</span> chmod +x bbr.sh <span class="o">&amp;&amp;</span> ./bbr.sh
</code></pre></div><p>跑完<code>uname -r</code>验证一下：</p>
<div class="highlight"><pre class="chroma"><code class="language-shell" data-lang="shell"><span class="o">[</span>root@1078503 ~<span class="o">]</span><span class="c1"># uname -r</span>
5.3.1-1.el7.elrepo.x86_64
<span class="o">[</span>root@1078503 ~<span class="o">]</span># 
</code></pre></div><p>如果你发现不是最新版本可能需要设置<code>grub2-set-default 0</code>，将升级的内核应用到启动项并重启机器验证。如果大佬的脚本你无法跑起来，可以考虑手动将内核库添加到系统，然后手动安装最新的内核。当然你还需要手动安装BBR加速等，这里只是提供思路，一般centos 7系统是可以完美运行的。</p>
<p>有了最新的系统内核和BBR加速，无论你是要搭梯子还是跑博客服务都会很流畅很科学了😁。我经常遇到IP没有被墙但梯子速度很慢或者没什么速度的情况，这时候我每次检查都是系统版本降级了，升级一下内核就又飞起来了（大多数情况是自己瞎折腾后没有检查造成的）。</p>
<p>当然，有些功能还需要安装最新版内核 headers ：</p>
<div class="highlight"><pre class="chroma"><code class="language-shell" data-lang="shell">yum --enablerepo<span class="o">=</span>elrepo-kernel -y install kernel-ml-headers
</code></pre></div><p>记得有朋友问我为什么你自己搭的梯子速度这么快，这一篇内容就是了。最新的系统内核加上BBR加速能不快吗？😄</p>
<p>如果只是放个博客其实这就无所谓了。不说了，我要去把我的博客搬到这台服务器上面了，保守估计放六个月的费用应该是够了。如果这期间它稳定我就一直放下去，反正便宜。</p>
<p>不过，当你看到这篇文章的时候我肯定已经搬完了。😁</p>
<hr>
<p>昨晚说了新开VPS需要做的一些工作。</p>
<p>隔天上午也就是现在想起来还需要补充一些。我们开的小鸡很容易被恶意扫描，有些频率过高的甚至会严重影响性能。这时候我们就需要采取一些措施，比如更改SSH的默认连接端口，还需要给SSH连接加上管理控制功能用于封禁不太友好的扫描IP。</p>
<p>其实做这些一个就够了：fail2ban。GitHub里面有大佬编译好的一键修改端口并安装fail2ban的脚本您可以自行搜索选择使用，真的很方便的，可以限制密码尝试次数和封禁IP时间多少小时等。我一般不完全封禁IP，众所周知这些来路的IP大多是VPS服务商的IP段，说不定哪天这个IP就被自己得到了那不就不太方便了吗？哈哈（其实一般这种情况很难出现）。</p>
</article><section class="article labels"><a class="category" href=/categories/%E7%94%B5%E8%84%91/>电脑</a><a class="tag" href=/tags/%E9%9A%8F%E7%AC%94/>随笔</a><a class="tag" href=/tags/kernel%E5%86%85%E6%A0%B8%E5%8D%87%E7%BA%A7/>kernel内核升级</a></section><section class="article navigation"><p><a class="link" href="/2019/09/8/"><span class="li">&larr;</span>【随笔】无标题但标题要长那就这样吧</a></p><p><a class="link" href="/2019/09/6/"><span class="li">&rarr;</span>【随笔】前天刚说完没动力昨晚回家就发现好事情😄</a></p></section>
<div align="center">
  <ins class="adsbygoogle" style="display:inline-block;width:728px;height:90px" data-ad-client="ca-pub-5883329460904326"
    data-ad-slot="6466278453"></ins>
  <script>
    (adsbygoogle = window.adsbygoogle || []).push({});
  </script>
</div>
<div align="center">
  <font color="red">点击评论框“加入讨论”会显示名字邮箱网址选项，不一定需要登陆哦🙂</font>
</div>
<div id="comment">
  <script>
    var disq = new iDisqus('comment', {
      forum: '1078503',
      api: 'https://dtz9.net/disqus/api/',
      site: 'https://dtz9.net',
      mode: 2,
      init: true
    });
  </script>
</div></div><section id="footer" class="footer"><div class="footer-wrap">
    <p class="copyright">©2019 - 2020 近视眼逛博客.</p>
    <p class="powerby"><span>Powered by </span><a href="https://gohugo.io" 
        target="_blank">Hugo</a><span> and the </span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank">Notepadium</a></p>
</div></section></div>
</body>

</html>